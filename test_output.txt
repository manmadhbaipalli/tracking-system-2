============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-7.4.3, pluggy-1.6.0 -- C:\Manmadh\genai\claude-code-agents\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Manmadh\genai\claude-code-agents\workspace\auth-spects-app-agent-1
configfile: pytest.ini
plugins: anyio-3.7.1, asyncio-0.21.1
asyncio: mode=Mode.AUTO
collecting ... collected 111 items

tests/integration/test_auth_routes.py::TestAuthRoutes::test_register_endpoint_success PASSED [  0%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_register_endpoint_invalid_email PASSED [  1%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_register_endpoint_short_password PASSED [  2%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_register_endpoint_duplicate_email PASSED [  3%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_register_endpoint_duplicate_username PASSED [  4%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_endpoint_with_email_success PASSED [  5%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_endpoint_with_username_success PASSED [  6%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_endpoint_wrong_password PASSED [  7%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_endpoint_nonexistent_user PASSED [  8%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_endpoint_missing_credentials PASSED [  9%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_endpoint_missing_password PASSED [  9%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_refresh_endpoint_success PASSED [ 10%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_refresh_endpoint_invalid_token PASSED [ 11%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_response_has_request_id PASSED [ 12%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_error_response_format PASSED [ 13%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_case_insensitive_email PASSED [ 14%]
tests/integration/test_auth_routes.py::TestAuthRoutes::test_register_response_includes_user_info PASSED [ 15%]
tests/integration/test_health_routes.py::TestHealthRoutes::test_health_endpoint PASSED [ 16%]
tests/integration/test_health_routes.py::TestHealthRoutes::test_health_endpoint_excluded_from_logging_middleware PASSED [ 17%]
tests/integration/test_middleware.py::TestMiddleware::test_exception_handler_catches_validation_errors PASSED [ 18%]
tests/integration/test_middleware.py::TestMiddleware::test_exception_handler_returns_consistent_format PASSED [ 18%]
tests/integration/test_middleware.py::TestMiddleware::test_request_id_in_response_header PASSED [ 19%]
tests/integration/test_middleware.py::TestMiddleware::test_request_id_uniqueness PASSED [ 20%]
tests/integration/test_middleware.py::TestMiddleware::test_cors_headers_present PASSED [ 21%]
tests/integration/test_middleware.py::TestMiddleware::test_error_response_includes_request_id PASSED [ 22%]
tests/integration/test_middleware.py::TestMiddleware::test_error_response_has_timestamp PASSED [ 23%]
tests/integration/test_middleware.py::TestMiddleware::test_error_code_present_in_all_errors PASSED [ 24%]
tests/integration/test_middleware.py::TestMiddleware::test_middleware_preserves_response_content PASSED [ 25%]
tests/integration/test_middleware.py::TestMiddleware::test_error_detail_for_invalid_credentials PASSED [ 26%]
tests/integration/test_middleware.py::TestMiddleware::test_database_error_returns_500 PASSED [ 27%]
tests/integration/test_middleware.py::TestMiddleware::test_response_content_type PASSED [ 27%]
tests/integration/test_swagger_and_docs.py::TestSwaggerDocs::test_swagger_ui_available PASSED [ 28%]
tests/integration/test_swagger_and_docs.py::TestSwaggerDocs::test_openapi_schema_available PASSED [ 29%]
tests/integration/test_swagger_and_docs.py::TestSwaggerDocs::test_openapi_schema_has_auth_endpoints PASSED [ 30%]
tests/integration/test_swagger_and_docs.py::TestSwaggerDocs::test_openapi_schema_has_health_endpoint PASSED [ 31%]
tests/integration/test_swagger_and_docs.py::TestSwaggerDocs::test_redoc_available PASSED [ 32%]
tests/integration/test_swagger_and_docs.py::TestSwaggerDocs::test_openapi_schema_has_tags PASSED [ 33%]
tests/integration/test_swagger_and_docs.py::TestSwaggerDocs::test_endpoints_have_descriptions PASSED [ 34%]
tests/integration/test_swagger_and_docs.py::TestSwaggerDocs::test_app_info_in_openapi PASSED [ 35%]
tests/unit/test_auth_service.py::TestAuthService::test_register_user_success PASSED [ 36%]
tests/unit/test_auth_service.py::TestAuthService::test_register_user_with_short_password PASSED [ 36%]
tests/unit/test_auth_service.py::TestAuthService::test_register_user_missing_email PASSED [ 37%]
tests/unit/test_auth_service.py::TestAuthService::test_register_user_missing_username PASSED [ 38%]
tests/unit/test_auth_service.py::TestAuthService::test_register_user_missing_password PASSED [ 39%]
tests/unit/test_auth_service.py::TestAuthService::test_register_user_duplicate_email PASSED [ 40%]
tests/unit/test_auth_service.py::TestAuthService::test_register_user_duplicate_username PASSED [ 41%]
tests/unit/test_auth_service.py::TestAuthService::test_login_with_email_success PASSED [ 42%]
tests/unit/test_auth_service.py::TestAuthService::test_login_with_username_success PASSED [ 43%]
tests/unit/test_auth_service.py::TestAuthService::test_login_wrong_password PASSED [ 44%]
tests/unit/test_auth_service.py::TestAuthService::test_login_nonexistent_user PASSED [ 45%]
tests/unit/test_auth_service.py::TestAuthService::test_login_missing_credentials PASSED [ 45%]
tests/unit/test_auth_service.py::TestAuthService::test_login_missing_password PASSED [ 46%]
tests/unit/test_auth_service.py::TestAuthService::test_refresh_access_token_success PASSED [ 47%]
tests/unit/test_auth_service.py::TestAuthService::test_refresh_invalid_token PASSED [ 48%]
tests/unit/test_auth_service.py::TestAuthService::test_refresh_token_for_deleted_user PASSED [ 49%]
tests/unit/test_auth_service.py::TestAuthService::test_password_hashed_in_database PASSED [ 50%]
tests/unit/test_auth_service.py::TestAuthService::test_email_case_normalization PASSED [ 51%]
tests/unit/test_auth_service.py::TestAuthService::test_login_with_uppercase_email PASSED [ 52%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_initial_state PASSED [ 53%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_successful_call PASSED [ 54%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_failure_threshold PASSED [ 54%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_open_raises_exception PASSED [ 55%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_half_open_state PASSED [ 56%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_half_open_fails PASSED [ 57%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_reset PASSED [ 58%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_failure_count_reset_on_success PASSED [ 59%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_with_custom_exception PASSED [ 60%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_unexpected_exception_not_counted PASSED [ 61%]
tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_concurrent_calls PASSED [ 62%]
tests/unit/test_exceptions.py::TestExceptions::test_app_exception_base PASSED [ 63%]
tests/unit/test_exceptions.py::TestExceptions::test_auth_exception PASSED [ 63%]
tests/unit/test_exceptions.py::TestExceptions::test_invalid_credentials_exception PASSED [ 64%]
tests/unit/test_exceptions.py::TestExceptions::test_user_already_exists_exception_default PASSED [ 65%]
tests/unit/test_exceptions.py::TestExceptions::test_user_already_exists_exception_with_field PASSED [ 66%]
tests/unit/test_exceptions.py::TestExceptions::test_token_expired_exception PASSED [ 67%]
tests/unit/test_exceptions.py::TestExceptions::test_validation_exception PASSED [ 68%]
tests/unit/test_exceptions.py::TestExceptions::test_database_exception PASSED [ 69%]
tests/unit/test_exceptions.py::TestExceptions::test_database_exception_custom_message PASSED [ 70%]
tests/unit/test_exceptions.py::TestExceptions::test_circuit_breaker_open_exception PASSED [ 71%]
tests/unit/test_exceptions.py::TestExceptions::test_user_not_found_exception PASSED [ 72%]
tests/unit/test_exceptions.py::TestExceptions::test_user_inactive_exception PASSED [ 72%]
tests/unit/test_exceptions.py::TestExceptions::test_exception_is_exception_subclass PASSED [ 73%]
tests/unit/test_jwt.py::TestJWTUtils::test_create_access_token PASSED    [ 74%]
tests/unit/test_jwt.py::TestJWTUtils::test_create_refresh_token PASSED   [ 75%]
tests/unit/test_jwt.py::TestJWTUtils::test_access_token_has_correct_payload PASSED [ 76%]
tests/unit/test_jwt.py::TestJWTUtils::test_refresh_token_has_correct_payload PASSED [ 77%]
tests/unit/test_jwt.py::TestJWTUtils::test_verify_valid_token PASSED     [ 78%]
tests/unit/test_jwt.py::TestJWTUtils::test_verify_invalid_token PASSED   [ 79%]
tests/unit/test_jwt.py::TestJWTUtils::test_verify_expired_token PASSED   [ 80%]
tests/unit/test_jwt.py::TestJWTUtils::test_extract_user_id_from_token PASSED [ 81%]
tests/unit/test_jwt.py::TestJWTUtils::test_extract_user_id_from_expired_token PASSED [ 81%]
tests/unit/test_jwt.py::TestJWTUtils::test_token_includes_expiration PASSED [ 82%]
tests/unit/test_jwt.py::TestJWTUtils::test_custom_expiration_delta PASSED [ 83%]
tests/unit/test_password.py::TestPasswordUtility::test_hash_password_creates_hash PASSED [ 84%]
tests/unit/test_password.py::TestPasswordUtility::test_hash_password_different_each_time PASSED [ 85%]
tests/unit/test_password.py::TestPasswordUtility::test_verify_password_correct_password PASSED [ 86%]
tests/unit/test_password.py::TestPasswordUtility::test_verify_password_incorrect_password PASSED [ 87%]
tests/unit/test_password.py::TestPasswordUtility::test_verify_password_case_sensitive PASSED [ 88%]
tests/unit/test_password.py::TestPasswordUtility::test_hash_empty_password PASSED [ 89%]
tests/unit/test_password.py::TestPasswordUtility::test_hash_long_password PASSED [ 90%]
tests/unit/test_user_service.py::TestUserService::test_create_user PASSED [ 90%]
tests/unit/test_user_service.py::TestUserService::test_get_user_by_id PASSED [ 91%]
tests/unit/test_user_service.py::TestUserService::test_get_user_by_id_not_found PASSED [ 92%]
tests/unit/test_user_service.py::TestUserService::test_get_user_by_email PASSED [ 93%]
tests/unit/test_user_service.py::TestUserService::test_get_user_by_email_case_insensitive PASSED [ 94%]
tests/unit/test_user_service.py::TestUserService::test_get_user_by_email_not_found PASSED [ 95%]
tests/unit/test_user_service.py::TestUserService::test_get_user_by_username PASSED [ 96%]
tests/unit/test_user_service.py::TestUserService::test_get_user_by_username_not_found PASSED [ 97%]
tests/unit/test_user_service.py::TestUserService::test_create_duplicate_email_raises_exception PASSED [ 98%]
tests/unit/test_user_service.py::TestUserService::test_create_duplicate_username_raises_exception PASSED [ 99%]
tests/unit/test_user_service.py::TestUserService::test_user_has_timestamps PASSED [100%]

============================== warnings summary ===============================
..\..\.venv\Lib\site-packages\pydantic\_internal\_config.py:268
..\..\.venv\Lib\site-packages\pydantic\_internal\_config.py:268
  C:\Manmadh\genai\claude-code-agents\.venv\Lib\site-packages\pydantic\_internal\_config.py:268: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

app\main.py:59
  C:\Manmadh\genai\claude-code-agents\workspace\auth-spects-app-agent-1\app\main.py:59: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    @app.on_event("startup")

..\..\.venv\Lib\site-packages\fastapi\applications.py:4547
..\..\.venv\Lib\site-packages\fastapi\applications.py:4547
  C:\Manmadh\genai\claude-code-agents\.venv\Lib\site-packages\fastapi\applications.py:4547: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    return self.router.on_event(event_type)

app\main.py:66
  C:\Manmadh\genai\claude-code-agents\workspace\auth-spects-app-agent-1\app\main.py:66: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    @app.on_event("shutdown")

tests/integration/test_auth_routes.py: 10 warnings
tests/integration/test_middleware.py: 1 warning
tests/unit/test_auth_service.py: 10 warnings
  C:\Manmadh\genai\claude-code-agents\workspace\auth-spects-app-agent-1\app\services\auth_service.py:69: PydanticDeprecatedSince20: The `from_orm` method is deprecated; set `model_config['from_attributes']=True` and use `model_validate` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
    user=UserResponse.from_orm(user),

tests/integration/test_auth_routes.py: 14 warnings
tests/integration/test_middleware.py: 1 warning
tests/unit/test_auth_service.py: 14 warnings
  C:\Manmadh\genai\claude-code-agents\.venv\Lib\site-packages\pydantic\main.py:1120: PydanticDeprecatedSince20: The `from_orm` method is deprecated; set `model_config["from_attributes"]=True` and use `model_validate` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
    warnings.warn(

tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_endpoint_with_email_success
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_endpoint_with_username_success
tests/integration/test_auth_routes.py::TestAuthRoutes::test_login_case_insensitive_email
tests/unit/test_auth_service.py::TestAuthService::test_login_with_email_success
tests/unit/test_auth_service.py::TestAuthService::test_login_with_username_success
tests/unit/test_auth_service.py::TestAuthService::test_login_with_uppercase_email
  C:\Manmadh\genai\claude-code-agents\workspace\auth-spects-app-agent-1\app\services\auth_service.py:112: PydanticDeprecatedSince20: The `from_orm` method is deprecated; set `model_config['from_attributes']=True` and use `model_validate` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
    user=UserResponse.from_orm(user),

tests/integration/test_auth_routes.py::TestAuthRoutes::test_refresh_endpoint_success
tests/unit/test_auth_service.py::TestAuthService::test_refresh_access_token_success
  C:\Manmadh\genai\claude-code-agents\workspace\auth-spects-app-agent-1\app\services\auth_service.py:139: PydanticDeprecatedSince20: The `from_orm` method is deprecated; set `model_config['from_attributes']=True` and use `model_validate` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
    user=UserResponse.from_orm(user),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
====================== 111 passed, 64 warnings in 17.77s ======================
