[
  {
    "id": "project-setup",
    "file": "requirements.txt",
    "description": "Python dependencies for FastAPI, SQLAlchemy, security, testing, and utilities",
    "acceptance_criteria": "All required packages listed with pinned versions; imports work without errors",
    "status": "pending"
  },
  {
    "id": "env-template",
    "file": ".env.example",
    "description": "Template environment variables for database, JWT, circuit breaker, logging configuration",
    "acceptance_criteria": "File contains all required environment variable templates with example values",
    "status": "pending"
  },
  {
    "id": "gitignore",
    "file": ".gitignore",
    "description": "Git ignore patterns for Python, venv, testing artifacts, IDE configs, environment files",
    "acceptance_criteria": ".env, __pycache__, .venv, .coverage are ignored",
    "status": "pending"
  },
  {
    "id": "readme",
    "file": "README.md",
    "description": "Project documentation with setup, usage, API endpoints, and contribution guidelines",
    "acceptance_criteria": "README includes setup instructions, how to run app and tests, API docs links",
    "status": "pending"
  },
  {
    "id": "app-init",
    "file": "app/__init__.py",
    "description": "Empty init file for app package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "config",
    "file": "app/config.py",
    "description": "Settings class with environment variables for database, JWT, security, logging, circuit breaker",
    "acceptance_criteria": "Settings loads from .env file; all required fields have defaults or are required",
    "status": "pending"
  },
  {
    "id": "database-init",
    "file": "app/database/__init__.py",
    "description": "Empty init file for database package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "database-connection",
    "file": "app/database/connection.py",
    "description": "SQLAlchemy async engine, session factory, and get_db dependency function",
    "acceptance_criteria": "Engine connects to PostgreSQL with asyncpg; get_db yields AsyncSession; connection pooling configured",
    "status": "pending"
  },
  {
    "id": "models-init",
    "file": "app/models/__init__.py",
    "description": "Empty init file for models package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "user-model",
    "file": "app/models/user.py",
    "description": "SQLAlchemy User ORM model with username, email, password_hash, account status, timestamps",
    "acceptance_criteria": "Model has all required columns; unique constraints on username and email; indexes on lookup fields",
    "status": "pending"
  },
  {
    "id": "schemas-init",
    "file": "app/schemas/__init__.py",
    "description": "Empty init file for schemas package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "user-schemas",
    "file": "app/schemas/user.py",
    "description": "Pydantic schemas: RegisterRequest, RegisterResponse, LoginRequest, LoginResponse with validators",
    "acceptance_criteria": "RegisterRequest validates username alphanumeric, email valid, password complex; responses match API spec",
    "status": "pending"
  },
  {
    "id": "handlers-init",
    "file": "app/handlers/__init__.py",
    "description": "Empty init file for handlers package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "exceptions",
    "file": "app/handlers/exceptions.py",
    "description": "Custom exception classes and FastAPI exception handlers for consistent error responses",
    "acceptance_criteria": "Defines AuthenticationError, UserAlreadyExistsError, ValidationError, AccountLockedError, CircuitBreakerOpenError; handlers return JSON with detail, error_code, timestamp, request_id",
    "status": "pending"
  },
  {
    "id": "services-init",
    "file": "app/services/__init__.py",
    "description": "Empty init file for services package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "auth-service",
    "file": "app/services/auth_service.py",
    "description": "AuthService with register_user, authenticate_user, password hashing, JWT token generation",
    "acceptance_criteria": "register_user validates input and creates user; authenticate_user verifies credentials and handles account locking; passwords hashed with bcrypt cost 12; rate limiting working (5 attempts/15 min)",
    "status": "pending"
  },
  {
    "id": "circuit-breaker",
    "file": "app/services/circuit_breaker.py",
    "description": "Circuit breaker pattern with CLOSED, OPEN, HALF_OPEN states for external service resilience",
    "acceptance_criteria": "CircuitBreaker has three states; transitions on failures/successes; configurable thresholds and timeouts; raises CircuitBreakerOpenError when OPEN",
    "status": "pending"
  },
  {
    "id": "routers-init",
    "file": "app/routers/__init__.py",
    "description": "Empty init file for routers package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "auth-router",
    "file": "app/routers/auth.py",
    "description": "FastAPI routes for POST /register and POST /login endpoints with proper request/response schemas",
    "acceptance_criteria": "POST /register returns 201 with RegisterResponse; POST /login returns 200 with LoginResponse; proper error handling with custom exceptions; endpoints appear in Swagger docs",
    "status": "pending"
  },
  {
    "id": "middleware-init",
    "file": "app/middleware/__init__.py",
    "description": "Empty init file for middleware package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "logging-middleware",
    "file": "app/middleware/logging.py",
    "description": "Middleware that injects request ID, logs request start/end with duration, includes correlation ID in responses",
    "acceptance_criteria": "Every request gets unique ID in request.state.request_id; logs include method, path, status, duration; X-Request-ID header in response",
    "status": "pending"
  },
  {
    "id": "utils-init",
    "file": "app/utils/__init__.py",
    "description": "Empty init file for utils package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "security-utils",
    "file": "app/utils/security.py",
    "description": "Security utilities: hash_password, verify_password (constant-time), create_access_token, decode_token",
    "acceptance_criteria": "hash_password uses bcrypt with cost 12; verify_password uses constant-time comparison; create_access_token generates JWT with HS256; decode_token verifies signature",
    "status": "pending"
  },
  {
    "id": "main-app",
    "file": "app/main.py",
    "description": "FastAPI app initialization with middleware, exception handlers, routes, health check endpoint",
    "acceptance_criteria": "App starts without errors; middleware added; exception handlers registered; auth router included at /api/v1/auth; health check returns 200; Swagger docs accessible at /docs",
    "status": "pending"
  },
  {
    "id": "migration-env",
    "file": "migrations/env.py",
    "description": "Alembic environment configuration for async SQLAlchemy",
    "acceptance_criteria": "Alembic configured for async database operations; renders SQLAlchemy DDL correctly",
    "status": "pending"
  },
  {
    "id": "migration-config",
    "file": "migrations/alembic.ini",
    "description": "Alembic configuration file with database URL and migration settings",
    "acceptance_criteria": "alembic.ini contains correct database URL configuration; migration discovery works",
    "status": "pending"
  },
  {
    "id": "migration-template",
    "file": "migrations/script.py.mako",
    "description": "Alembic migration template",
    "acceptance_criteria": "Template is valid Mako and generates proper Python migration files",
    "status": "pending"
  },
  {
    "id": "initial-migration",
    "file": "migrations/versions/001_initial.py",
    "description": "Initial database migration creating users table with all columns, constraints, and indexes",
    "acceptance_criteria": "Migration creates users table with id, username, email, password_hash, account status, login attempts tracking, timestamps; unique constraints on username/email; indexes on lookup fields; upgrade and downgrade work",
    "status": "pending"
  },
  {
    "id": "tests-init",
    "file": "tests/__init__.py",
    "description": "Empty init file for tests package",
    "acceptance_criteria": "File exists and can be imported as package",
    "status": "pending"
  },
  {
    "id": "test-conftest",
    "file": "tests/conftest.py",
    "description": "Pytest fixtures for test database, database session, FastAPI test client, test user",
    "acceptance_criteria": "test_db fixture creates in-memory database; db_session fixture provides AsyncSession; client fixture returns TestClient; test_user_credentials fixture provides valid credentials; all fixtures work with async",
    "status": "pending"
  },
  {
    "id": "test-auth-endpoints",
    "file": "tests/test_auth.py",
    "description": "Integration tests for authentication endpoints (register, login) with validation and error cases",
    "acceptance_criteria": "Tests for successful registration and login; duplicate email; invalid password; wrong credentials; user not found; account locked; swagger docs accessible; all tests pass",
    "status": "pending"
  },
  {
    "id": "test-services",
    "file": "tests/test_services.py",
    "description": "Unit tests for AuthService methods (register, authenticate, password operations, rate limiting)",
    "acceptance_criteria": "Tests for register success/duplicate/validation; login success/invalid/locked; failed attempts increment; account locks after max attempts; locks expire; all tests pass",
    "status": "pending"
  },
  {
    "id": "test-circuit-breaker",
    "file": "tests/test_circuit_breaker.py",
    "description": "Unit tests for CircuitBreaker state transitions and behavior",
    "acceptance_criteria": "Tests for CLOSED state; opens after failures; HALF_OPEN after timeout; closes on success; opens again on failure; all tests pass",
    "status": "pending"
  },
  {
    "id": "test-models",
    "file": "tests/test_models.py",
    "description": "Unit tests for SQLAlchemy models (User model fields, constraints, relationships)",
    "acceptance_criteria": "Tests for User model creation; unique constraints enforced; timestamps updated; indexes exist; all tests pass",
    "status": "pending"
  },
  {
    "id": "test-coverage",
    "acceptance_criteria": "Code coverage >= 80% on app/ directory; coverage report generated",
    "description": "Overall test coverage requirement",
    "status": "pending"
  },
  {
    "id": "code-quality",
    "acceptance_criteria": "Black formatting passes; Flake8 linting passes; no obvious security issues; follows PEP 8",
    "description": "Code quality checks (formatting, linting, security)",
    "status": "pending"
  }
]
