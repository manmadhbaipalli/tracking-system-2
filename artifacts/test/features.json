[
  {
    "id": "config",
    "file": "app/config.py",
    "description": "Environment-based configuration for dev/test/prod with database URL, JWT settings, and debug mode",
    "acceptance_criteria": "Module imports without error, Settings class has required attributes (database_url, jwt_secret_key, jwt_algorithm, token_expiry_minutes, debug, environment)",
    "status": "pending"
  },
  {
    "id": "db_setup",
    "file": "app/db.py",
    "description": "SQLAlchemy engine, session factory, Base declarative class, and get_db dependency for FastAPI",
    "acceptance_criteria": "Module imports without error, engine created without error, SessionLocal returns sessions, Base class is declarative, get_db() returns Session object",
    "status": "pending"
  },
  {
    "id": "exceptions",
    "file": "app/utils/exceptions.py",
    "description": "Custom exception classes (AppException, ValidationError, AuthenticationError, NotFoundError, ConflictError, ExternalServiceError) with status codes",
    "acceptance_criteria": "All exception classes defined and inherit from AppException, each has status_code attribute, can be instantiated with message",
    "status": "pending"
  },
  {
    "id": "logging_config",
    "file": "app/utils/logging.py",
    "description": "Logging configuration with StreamHandler, format strings, and get_logger function",
    "acceptance_criteria": "Module imports without error, get_logger() returns configured logger, output includes timestamp, level, name, message",
    "status": "pending"
  },
  {
    "id": "exception_middleware",
    "file": "app/middleware/exception.py",
    "description": "Global exception handler middleware that converts exceptions to consistent JSON error responses",
    "acceptance_criteria": "Middleware catches all exceptions, returns JSON with status_code, detail, request_id fields, HTTP status matches exception status_code",
    "status": "pending"
  },
  {
    "id": "logging_middleware",
    "file": "app/middleware/logging.py",
    "description": "Request/response logging middleware with unique request ID generation for correlation",
    "acceptance_criteria": "Middleware generates unique request ID per request, logs HTTP method and path, logs response status and duration, stores request_id in request state",
    "status": "pending"
  },
  {
    "id": "circuit_breaker",
    "file": "app/circuit_breaker/breaker.py",
    "description": "Circuit breaker wrapper around pybreaker for protecting external API calls with state management",
    "acceptance_criteria": "Module imports without error, create_breaker() creates working breaker, breaker_decorator applies to functions, state transitions (closed->open->half-open) work correctly",
    "status": "pending"
  },
  {
    "id": "user_model",
    "file": "app/auth/models.py",
    "description": "SQLAlchemy User model with id, email (unique), hashed_password, and created_at fields",
    "acceptance_criteria": "Model inherits from Base, has all required columns, email has unique constraint, created_at defaults to current time, can be instantiated and queried",
    "status": "pending"
  },
  {
    "id": "auth_schemas",
    "file": "app/auth/schemas.py",
    "description": "Pydantic schemas for UserRegister, UserLogin, UserResponse, TokenResponse",
    "acceptance_criteria": "All schemas defined, UserRegister/UserLogin accept email and password, UserResponse has id/email/created_at, TokenResponse has access_token and token_type, validation works",
    "status": "pending"
  },
  {
    "id": "auth_service",
    "file": "app/auth/service.py",
    "description": "Authentication business logic with password hashing, JWT token generation/verification, user registration and login",
    "acceptance_criteria": "hash_password() returns bcrypt hash, verify_password() validates correctly, create_access_token() generates valid JWT, verify_token() parses JWT and returns user_id, register_user() creates User and raises ConflictError on duplicate, login_user() validates credentials",
    "status": "pending"
  },
  {
    "id": "auth_router",
    "file": "app/auth/router.py",
    "description": "FastAPI router with POST /api/v1/auth/register and POST /api/v1/auth/login endpoints",
    "acceptance_criteria": "register endpoint accepts UserRegister, returns UserResponse with 201 status, raises ConflictError on duplicate, login endpoint accepts UserLogin, returns TokenResponse with 200 status, raises AuthenticationError on invalid credentials",
    "status": "pending"
  },
  {
    "id": "main_app",
    "file": "app/main.py",
    "description": "FastAPI application initialization with middleware registration, router setup, and health check endpoint",
    "acceptance_criteria": "FastAPI app created without error, exception middleware registered, logging middleware registered, auth router registered at /api/v1/auth, GET / returns 200 with status message, Swagger docs available at /docs",
    "status": "pending"
  },
  {
    "id": "app_init",
    "file": "app/__init__.py",
    "description": "Empty init file to mark app as Python package",
    "acceptance_criteria": "File exists and is empty or minimal",
    "status": "pending"
  },
  {
    "id": "middleware_init",
    "file": "app/middleware/__init__.py",
    "description": "Empty init file to mark middleware as Python package",
    "acceptance_criteria": "File exists and is empty or minimal",
    "status": "pending"
  },
  {
    "id": "auth_init",
    "file": "app/auth/__init__.py",
    "description": "Empty init file to mark auth as Python package",
    "acceptance_criteria": "File exists and is empty or minimal",
    "status": "pending"
  },
  {
    "id": "circuit_breaker_init",
    "file": "app/circuit_breaker/__init__.py",
    "description": "Empty init file to mark circuit_breaker as Python package",
    "acceptance_criteria": "File exists and is empty or minimal",
    "status": "pending"
  },
  {
    "id": "utils_init",
    "file": "app/utils/__init__.py",
    "description": "Empty init file to mark utils as Python package",
    "acceptance_criteria": "File exists and is empty or minimal",
    "status": "pending"
  },
  {
    "id": "requirements",
    "file": "requirements.txt",
    "description": "Python dependencies including FastAPI, SQLAlchemy, PyJWT, pybreaker, bcrypt, pytest",
    "acceptance_criteria": "File contains all required packages with version specifiers, pip install succeeds without errors",
    "status": "pending"
  },
  {
    "id": "pytest_config",
    "file": "pytest.ini",
    "description": "Pytest configuration with asyncio_mode, testpaths, and python_files settings",
    "acceptance_criteria": "File exists and contains asyncio_mode=auto, testpaths=tests, python_files=test_*.py",
    "status": "pending"
  },
  {
    "id": "env_example",
    "file": ".env.example",
    "description": "Environment variables template with DATABASE_URL, JWT_SECRET_KEY, ENVIRONMENT",
    "acceptance_criteria": "File exists and contains example values for required env vars",
    "status": "pending"
  },
  {
    "id": "conftest",
    "file": "tests/conftest.py",
    "description": "Pytest fixtures for test database, TestClient, sample user, and other test utilities",
    "acceptance_criteria": "test_db fixture provides in-memory SQLite database, test_client fixture provides FastAPI TestClient, sample_user fixture creates test user, fixtures are properly scoped",
    "status": "pending"
  },
  {
    "id": "test_auth",
    "file": "tests/test_auth.py",
    "description": "Unit and integration tests for registration, login, password hashing, and token verification",
    "acceptance_criteria": "All auth service functions tested, register and login endpoints tested, password hashing verified, JWT token verification works, edge cases tested (duplicate email, invalid credentials)",
    "status": "pending"
  },
  {
    "id": "test_logging",
    "file": "tests/test_logging.py",
    "description": "Tests for logging middleware, request ID generation, and log output format",
    "acceptance_criteria": "Request ID generated and stored in request state, logs include HTTP method and path, logs include response status and duration, request ID appears in error responses",
    "status": "pending"
  },
  {
    "id": "test_circuit_breaker",
    "file": "tests/test_circuit_breaker.py",
    "description": "Tests for circuit breaker state transitions, open/closed/half-open states, and fail fast behavior",
    "acceptance_criteria": "Breaker closes after success, opens after fail_max failures, half-opens after reset_timeout, returns ExternalServiceError when open, tracks metrics correctly",
    "status": "pending"
  },
  {
    "id": "tests_init",
    "file": "tests/__init__.py",
    "description": "Empty init file to mark tests as Python package",
    "acceptance_criteria": "File exists and is empty or minimal",
    "status": "pending"
  }
]
